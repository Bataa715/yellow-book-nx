(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[350],{43:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(5394).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},1773:(e,s,t)=>{"use strict";t.d(s,{default:()=>r.a});var a=t(4930),r=t.n(a)},1896:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(5394).A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},2080:(e,s,t)=>{Promise.resolve().then(t.bind(t,2510))},2503:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(5394).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},2510:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>C});var a=t(4568),r=t(7620),n=t(2942),l=t(1938),i=t(60),c=t(880),o=t(7227),d=t(5725),u=t(5165),h=t(3353),m=t(3547),x=t(7129),j=t(4601),p=t(2996),f=t(43),y=t(6578),g=t(1896),v=t(2503),b=t(7261),w=t.n(b),N=t(1773);let k=c.Ik({businessName:c.Yj().min(2,"Нэр дор хаяж 2 үсэгтэй байх ёстой."),description:c.Yj().min(20,"Тайлбар дор хаяж 20 тэмдэгттэй байх ёстой."),categories:c.YO(c.Yj()).min(1,"Дор хаяж нэг ангилал сонгоно уу."),phone:c.Yj().min(8,"Утасны дугаар буруу байна."),email:c.Yj().email("Имэйл хаяг буруу байна.").optional().or(c.eu("")),website:c.Yj().url("Вэбсайт хаяг буруу байна.").optional().or(c.eu("")),address:c.Yj().min(5,"Хаяг дор хаяж 5 тэмдэгттэй байх ёстой."),images:c.YO(c.Yj()).default([])});function C(){let e=(0,n.useParams)(),s=(0,n.useRouter)(),t=e.id,{toast:c}=(0,m.dj)(),[b,C]=(0,r.useState)(null),[z,A]=(0,r.useState)(!0),R=(0,l.mN)({resolver:(0,i.u)(k),mode:"onChange",defaultValues:{businessName:"",description:"",categories:[],phone:"",email:"",website:"",address:"",images:[]}});async function M(e){try{let a=await fetch("http://localhost:3001/api/yellow-books/".concat(t),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!a.ok)throw Error("Failed to update business");await a.json(),c({title:"Амжилттай шинэчиллээ!",description:'"'.concat(e.businessName,'" нэртэй бизнес амжилттай засагдлаа.')}),s.push("/admin/businesses")}catch(e){console.error("Error updating business:",e),c({variant:"destructive",title:"Алдаа",description:"Бизнесийн мэдээллийг шинэчлэхэд алдаа гарлаа."})}}(0,r.useEffect)(()=>{t&&(async()=>{A(!0);try{let e=await fetch("http://localhost:3001/api/yellow-books/".concat(t)),s=await e.json();C(s.data),R.reset({businessName:s.data.name,description:s.data.description,categories:s.data.categories,phone:Array.isArray(s.data.contact.phone)?s.data.contact.phone.join(", "):s.data.contact.phone,email:s.data.contact.email||"",website:s.data.contact.website||"",address:s.data.address.full,images:s.data.images||[]})}catch(e){console.error("Failed to fetch business",e),c({variant:"destructive",title:"Алдаа",description:"Бизнесийн мэдээллийг татахад алдаа гарлаа."})}finally{A(!1)}})()},[t,R,c]);let{fields:P,append:I,remove:B}=(0,l.jz)({control:R.control,name:"images"});return z?(0,a.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,a.jsx)(f.A,{className:"h-12 w-12 animate-spin text-primary"})}):b?(0,a.jsxs)("div",{className:"container mx-auto max-w-4xl py-12 px-4 md:px-6",children:[(0,a.jsx)("div",{className:"mb-8",children:(0,a.jsx)(o.$,{asChild:!0,variant:"outline",children:(0,a.jsxs)(w(),{href:"/admin/businesses",children:[(0,a.jsx)(y.A,{className:"mr-2 h-4 w-4"}),"Бизнесийн жагсаалт руу буцах"]})})}),(0,a.jsxs)(h.Zp,{className:"shadow-xl",children:[(0,a.jsxs)(h.aR,{children:[(0,a.jsx)(h.ZB,{className:"text-3xl font-headline",children:"Бизнес засах"}),(0,a.jsxs)(h.BT,{children:['"',b.name,'"-н мэдээллийг шинэчлэх.']})]}),(0,a.jsx)(h.Wu,{children:(0,a.jsx)(d.lV,{...R,children:(0,a.jsxs)("form",{onSubmit:R.handleSubmit(M),className:"space-y-8",children:[(0,a.jsx)(d.zB,{control:R.control,name:"businessName",render:e=>{let{field:s}=e;return(0,a.jsxs)(d.eI,{children:[" ",(0,a.jsx)(d.lR,{children:"Бизнесийн нэр"})," ",(0,a.jsxs)(d.MJ,{children:[" ",(0,a.jsx)(u.p,{...s})," "]})," ",(0,a.jsx)(d.C5,{})," "]})}}),(0,a.jsx)(d.zB,{control:R.control,name:"description",render:e=>{let{field:s}=e;return(0,a.jsxs)(d.eI,{children:[" ",(0,a.jsx)(d.lR,{children:"Дэлгэрэнгүй тайлбар"})," ",(0,a.jsxs)(d.MJ,{children:[" ",(0,a.jsx)(x.T,{rows:6,...s})," "]})," ",(0,a.jsx)(d.C5,{})," "]})}}),(0,a.jsx)(d.zB,{control:R.control,name:"categories",render:()=>(0,a.jsxs)(d.eI,{children:[" ",(0,a.jsx)(d.lR,{children:"Ангилал"})," ",(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 pt-2",children:[" ",j.zA.map(e=>(0,a.jsx)(d.zB,{control:R.control,name:"categories",render:s=>{var t;let{field:r}=s;return(0,a.jsxs)(d.eI,{className:"flex flex-row items-start space-x-3 space-y-0",children:[" ",(0,a.jsxs)(d.MJ,{children:[" ",(0,a.jsx)(p.S,{checked:null==(t=r.value)?void 0:t.includes(e.name),onCheckedChange:s=>{var t;return s?r.onChange([...r.value,e.name]):r.onChange(null==(t=r.value)?void 0:t.filter(s=>s!==e.name))}})," "]})," ",(0,a.jsx)(d.lR,{className:"font-normal",children:e.name})," "]},e.id)}},e.id))," "]})," ",(0,a.jsx)(d.C5,{})," "]})}),(0,a.jsx)(d.zB,{control:R.control,name:"images",render:()=>(0,a.jsxs)(d.eI,{children:[(0,a.jsx)(d.lR,{children:"Зургийн цомог"}),(0,a.jsx)(d.Rr,{children:"Зургийн URL-уудыг оруулна уу."}),(0,a.jsxs)("div",{className:"space-y-4",children:[P.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"relative w-16 h-16 rounded-md overflow-hidden border",children:(0,a.jsx)(N.default,{src:R.watch("images.".concat(s))||"https://picsum.photos/200/200?grayscale",alt:"Зураг ".concat(s+1),fill:!0,className:"object-cover"})}),(0,a.jsx)(d.zB,{control:R.control,name:"images.".concat(s),render:e=>{let{field:s}=e;return(0,a.jsx)(u.p,{...s,className:"flex-grow",placeholder:"https://example.com/image.jpg"})}}),(0,a.jsx)(o.$,{type:"button",variant:"destructive",size:"icon",onClick:()=>B(s),children:(0,a.jsx)(g.A,{className:"h-4 w-4"})})]},e.id)),(0,a.jsxs)(o.$,{type:"button",variant:"outline",onClick:()=>I(""),children:[(0,a.jsx)(v.A,{className:"mr-2 h-4 w-4"}),"Шинэ зураг нэмэх"]})]}),(0,a.jsx)(d.C5,{})]})}),(0,a.jsx)(d.zB,{control:R.control,name:"phone",render:e=>{let{field:s}=e;return(0,a.jsxs)(d.eI,{children:[" ",(0,a.jsx)(d.lR,{children:"Утасны дугаар"})," ",(0,a.jsxs)(d.MJ,{children:[" ",(0,a.jsx)(u.p,{...s})," "]})," ",(0,a.jsx)(d.Rr,{children:"Олон дугаар бол таслалаар (,) тусгаарлана уу."})," ",(0,a.jsx)(d.C5,{})," "]})}}),(0,a.jsx)(d.zB,{control:R.control,name:"email",render:e=>{let{field:s}=e;return(0,a.jsxs)(d.eI,{children:[" ",(0,a.jsx)(d.lR,{children:"Имэйл хаяг"})," ",(0,a.jsxs)(d.MJ,{children:[" ",(0,a.jsx)(u.p,{type:"email",...s})," "]})," ",(0,a.jsx)(d.C5,{})," "]})}}),(0,a.jsx)(d.zB,{control:R.control,name:"website",render:e=>{let{field:s}=e;return(0,a.jsxs)(d.eI,{children:[" ",(0,a.jsx)(d.lR,{children:"Вэбсайт"})," ",(0,a.jsxs)(d.MJ,{children:[" ",(0,a.jsx)(u.p,{...s})," "]})," ",(0,a.jsx)(d.C5,{})," "]})}}),(0,a.jsx)(d.zB,{control:R.control,name:"address",render:e=>{let{field:s}=e;return(0,a.jsxs)(d.eI,{children:[" ",(0,a.jsx)(d.lR,{children:"Дэлгэрэнгүй хаяг"})," ",(0,a.jsxs)(d.MJ,{children:[" ",(0,a.jsx)(u.p,{...s})," "]})," ",(0,a.jsx)(d.C5,{})," "]})}}),(0,a.jsx)(o.$,{type:"submit",size:"lg",className:"w-full",children:"Хадгалах"})]})})})]})]}):(0,a.jsx)("div",{className:"container text-center py-10",children:"Бизнес олдсонгүй."})}},2942:(e,s,t)=>{"use strict";var a=t(2418);t.o(a,"useParams")&&t.d(s,{useParams:function(){return a.useParams}}),t.o(a,"useRouter")&&t.d(s,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(s,{useSearchParams:function(){return a.useSearchParams}})},4930:(e,s,t)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),!function(e,s){for(var t in s)Object.defineProperty(e,t,{enumerable:!0,get:s[t]})}(s,{default:function(){return c},getImageProps:function(){return i}});let a=t(1510),r=t(7258),n=t(3970),l=a._(t(170));function i(e){let{props:s}=(0,r.getImgProps)(e,{defaultLoader:l.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,t]of Object.entries(s))void 0===t&&delete s[e];return{props:s}}let c=n.Image},6578:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(5394).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])}},e=>{var s=s=>e(e.s=s);e.O(0,[114,261,970,983,938,988,550,587,315,358],()=>s(2080)),_N_E=e.O()}]);